# Project:基于RNN的唐诗生成模型

一个基于Simple RNN的唐诗生成模型，能够根据输入的起始文本自动生成符合唐诗风格的诗歌。

## 项目介绍

本项目利用循环神经网络(RNN)构建了一个唐诗生成器，通过学习唐诗文本的特征和规律，能够根据用户提供的起始文本，自动生成连贯且具有唐诗风格的诗歌。

模型使用字符级别的序列预测方法，将每首诗视为字符序列，通过学习序列中的模式来预测下一个可能出现的字符，从而实现诗歌的自动生成。

## 环境要求

- Python 3.x
- numpy
- tensorflow 2.x(tf 2.10以后Windows平台不再内置GPU加速)

可以通过以下命令安装所需依赖：
```bash
pip install numpy tensorflow
```

## 文件结构

- `model.py`：模型训练脚本，用于处理数据、构建模型并进行训练
- `Application.py`：应用程序脚本，用于加载训练好的模型并提供交互式诗歌生成功能
- `data/`：存放原始唐诗文本文件的目录
- `corpus.txt`：处理后的语料文件（由model.py生成）
- `simple_rnn_tang_poem_generator.h5`：训练好的模型文件（由model.py生成）
- `training_history.txt`：训练过程记录（由model.py生成）

## 使用方法

### 1. 准备数据

1. 在项目根目录下创建`data`文件夹
2. 将唐诗文本文件（.txt格式）放入`data`文件夹中

### 2. 训练模型

运行模型训练脚本：
```bash
python model.py
```

训练过程中会：
- 合并`data`目录下的所有txt文件
- 构建词汇表和训练数据集
- 构建并训练Simple RNN模型
- 保存训练好的模型和训练历史

#### 配置参数（可选）
打可根据需求调整核心参数（参数已标注说明）：

|参数名	| 含义	                                    | 默认值	                    | 调整建议                                        |
|---|----------------------------------------|-------------------------|---------------------------------------------|
|seq_length	| 训练用序列长度（输入字符数）	| 5| 	长度越大，上下文信息越丰富，但训练难度增加                      |
|embedding_dim	| 字符嵌入维度	| 512	                    | 维度越大，特征表达能力越强，需配合更大 batch                   |
|RNN_units	| RNN 隐藏层单元数	| 256	                    | 单元数越多，模型容量越大，避免过拟合                          |
|epochs	| 训练轮数	| 20	                     | 数据量小时可增加（如 50），观察损失下降情况                     |
|batch_size	| 批次大小	| 64                      | 	                      GPU 内存不足时减小（如 32、16） |
|learning_rate	| 学习率	                                   | 0.001	                  | 损失下降缓慢时可适当调大（如 0.005）                       |

### 3. 生成诗歌

运行应用程序脚本：
```bash
python Application.py
```

按照提示输入：
- 至少5个字符的起始文本（作为诗歌的开头）
- 生成温度（0.1-2.0之间，值越小生成结果越稳定，越大越随机）

程序会自动生成完整的唐诗并展示。输入`exit`可以退出程序。

## 配置参数说明

### 训练参数（model.py）
- `seq_length`：序列长度，默认为5
- `embedding_dim`：词嵌入维度，默认为512
- `RNN_units`：RNN隐藏层单元数，默认为256
- `learning_rate`：学习率，默认为0.001
- `epochs`：训练轮数，默认为20
- `batch_size`：批次大小，默认为64

### 生成参数（Application.py）
- `max_length`：生成诗歌的最大长度，默认为200
- `temperature`：控制生成的随机性，用户可在交互时指定

## 注意事项

1. 首次运行需先执行`model.py`训练模型，生成必要的模型文件和语料文件
2. 训练模型可能需要较长时间，取决于硬件性能
3. 输入的起始文本质量会影响生成结果，建议使用与唐诗风格相符的起始文本
4. 生成温度的选择会显著影响结果，较低的值会生成更保守、更可预测的文本，较高的值会带来更多变化但可能导致文本不连贯
