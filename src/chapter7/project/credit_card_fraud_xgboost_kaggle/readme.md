# Project:信用卡欺诈检测

## 项目简介
本项目基于信用卡交易数据集，使用 XGBoost 算法构建欺诈检测模型，通过输入信用卡交易的特征数据，预测该交易为欺诈的概率，并将结果保存为 CSV 文件。模型旨在帮助识别潜在的欺诈交易，降低金融风险。

## 数据集说明
- 来源：数据集来自 Kaggle 平台，具体地址为：[Credit Card Fraud Detection](https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud "Credit Card Fraud Detection") 
- 内容：包含信用卡交易记录，特征主要为经过 PCA 处理的匿名特征（V1-V28），以及非匿名特征（Time、Amount、Class）。其中：
  - Time：交易时间（距离第一笔交易的秒数）
  - Amount：交易金额
  - Class：标签（0 表示正常交易，1 表示欺诈交易）
- 样本特点：共约 28.4 万条记录，其中欺诈样本（Class=1）占比极低（约 0.17%），存在严重的数据不平衡问题。

## 文件说明
- training.py：模型训练脚本，包含数据加载、预处理、不平衡处理、模型训练及评估等功能
- application.py：模型预测脚本，读取输入数据并输出欺诈概率结果
- model.pkl：训练好的 XGBoost 模型文件（由training.py生成）
- scaler.pkl：特征标准化器（由training.py生成，用于Amount特征的标准化）
- report.txt：模型评估报告（由training.py生成）
- creditcard.csv：原始数据集（**需用户从 Kaggle 下载**）
- data.csv：输入预测数据（用户提供，需包含模型所需特征）
- data_with_prob.csv：预测结果输出文件（由application.py生成，包含原始数据及欺诈概率）

## 使用步骤
### 1. 准备数据
从Kaggle 下载creditcard.csv，放入项目根目录。
### 2. 模型训练
运行`training.py`进行模型训练：

```
bash
python training.py
```
执行流程：

- 加载原始数据并查看基本信息（如欺诈样本比例）
- 数据预处理：对Amount特征进行标准化，生成Amount_scaled
- 数据集划分：按 7:3 比例划分训练集和测试集，使用分层抽样保持类别比例
- 解决数据不平衡：通过 SMOTE 过采样生成少数类（欺诈）样本，平衡训练数据
- 训练 XGBoost 模型：设置scale_pos_weight调整正负样本权重，优化不平衡数据表现
- 模型评估：计算准确率、精确率、召回率等指标，生成report.txt
- 保存模型：生成model.pkl（模型）和scaler.pkl（标准化器）
### 3. 欺诈预测
运行`application.py`进行欺诈概率预测：

```
bash
python application.py
```
执行流程：

- 读取输入数据data.csv（需包含模型所需特征）
- 数据预处理：使用scaler.pkl对Amount特征标准化，生成Amount_scaled
- 加载模型model.pkl，预测交易为欺诈的概率（取第二类概率）
- 结果处理：将概率转换为百分比格式（保留 4 位小数），添加至possibility列
- 保存结果：生成data_with_prob.csv，包含原始数据及欺诈概率

## 模型评估结果
模型在测试集（约 8.5 万条数据）上的表现如下：

|类别（Class）|精确率（precision）|召回率（recall）|F1 分数（f1-score）|样本数（support）|
|-----------|-----------------|---------------|-----------------|--------------|
|0（正常交易）|1.00|1.00|1.00|85295|
|1（欺诈交易）|0.85|0.82|0.84|148|

- 总体准确率（accuracy）：1.00
- 宏平均（macro avg）：0.92（精确率、召回率、F1 分数）
- 加权平均（weighted avg）：1.00（精确率、召回率、F1 分数）

模型对正常交易识别准确率较高，对欺诈交易的识别精确率和召回率分别为 85% 和 82%，能有效捕捉多数欺诈行为。

## 项目难点及解决方式
### 数据不平衡（Skewed Data）
问题：欺诈样本仅占 0.17%，若直接训练，模型易偏向多数类（正常交易），导致欺诈样本识别率低。
### 解决方式：
- SMOTE 过采样：通过插值生成少数类（欺诈）样本，平衡训练集中正负样本比例（本项目设置采样比例为 0.02）。
- XGBoost 权重调整：设置scale_pos_weight参数，为少数类（欺诈）分配更高权重，提升模型对欺诈样本的关注度。
- 阈值调整：将预测阈值从默认 0.5 降低至 0.3，提高欺诈样本的召回率（减少漏检）。
## 项目不足之处
### SMOTE 过采样的局限性
SMOTE 生成的少数类样本可能与真实欺诈样本存在差异，可能引入噪声，影响模型泛化能力。
### 阈值敏感性
预测阈值（0.3）是固定的，实际场景中需根据业务需求（如 “减少漏检” 或 “减少误判”）动态调整，目前未支持自适应阈值设置。
### 特征依赖
模型依赖原始数据集的特征分布（如 PCA 处理后的 V1-V28），若新数据特征分布发生变化（如交易模式改变），模型性能可能下降。
### 特征工程深度不足
未深入挖掘特征间的交互关系（如Time与欺诈的时间模式关联），可能遗漏潜在有效特征。
### 模型单一性
使用 XGBoost 模型，未尝试集成多个模型（如随机森林 + XGBoost）进一步提升鲁棒性。