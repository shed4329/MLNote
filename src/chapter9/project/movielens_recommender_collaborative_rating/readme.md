# Project:基于协同过滤的电影推荐系统

## 项目介绍
这是一个基于矩阵分解的协同过滤电影推荐系统，使用 MovieLens 10% 数据集构建，能够根据用户对电影的评分历史生成个性化推荐。


该系统通过矩阵分解算法对用户 - 电影评分矩阵进行分解，提取用户和电影的潜在特征，从而预测用户对未观看电影的评分，并据此提供个性化推荐。对于新用户，系统会通过引导其对少量电影进行评分来构建用户特征，进而生成推荐。

## 数据集介绍
项目使用MovieLens 10% 数据集，该数据集是由明尼苏达大学 GroupLens 研究小组收集的电影评分数据集的子集，包含约 10 万条用户对电影的评分记录，涵盖了 610 位用户对 9742 部电影的100836评分数据。

具体使用文件如下：

- `ratings.csv`：用户对电影的评分数据，格式为userId,movieId,rating,timestamp
  - `userId`：用户唯一标识
  - `movieId`：电影唯一标识
  - `rating`：用户对电影的评分（1-5 分）
  - `timestamp`：评分时间戳
- `movies.csv`：电影元数据，格式为movieId,title,genres
  - `title`：电影名称（含年份）
  - `genres`：电影类型（多类型用|分隔）

## 项目结构
```text
project/
├── dataset/           # 数据集目录
│   ├── ratings.csv    # 电影评分数据（MovieLens 10%子集）
│   ├── movies.csv     # 电影元数据
│   └── 其他没用到的文件  
├── models/            # 模型保存目录（训练后生成）
│   ├── user_features.npy     # 用户特征矩阵
│   ├── item_features.npy     # 电影特征矩阵
│   ├── user_biases.npy       # 用户偏置项
│   ├── item_id_map.csv       # 电影ID映射表
│   └── movie_means.csv       # 电影平均评分
├── code/              # 代码目录
│   ├── explore.py         # 数据探索脚本
│   ├── model.py           # 模型训练脚本
│   └── Application.py     # 推荐应用程序（交互式推荐）
└── readme.md            # 项目说明文档
```
## 使用方法
### 数据探索
运行`explore.py`查看数据集统计信息：
```
bash
python explore.py
```
输出内容包括：

- 评分数据和电影数据的前 5 行记录
- 电影数量、用户数量和评分总数
- 评分分布（各分数出现次数）
- 电影类型分布（各类型电影数量）
- 缺失值和重复值检查结果
### 模型训练
运行`model.py`训练推荐模型：
```
bash
python model.py
```
训练过程说明：

- 数据集按用户分组划分为训练集（70%）和测试集（30%）
- 使用矩阵分解算法学习用户特征和电影特征
- 采用带正则化的均方误差作为损失函数
- 训练完成后输出模型在测试集上的 MSE、RMSE 和 MAE 指标
- 模型参数保存至models目录

可通过修改main函数参数调整训练配置：


```python

main(
    feature_dim=20,    # 特征维度
    lambda_reg=0.01,   # 正则化系数
    epochs=50,         # 训练轮数
    batch_size=256,    # 批次大小
    learning_rate=0.001 # 学习率
)
```
3. 生成推荐
运行`Application.py`获取个性化推荐：
```
bash
python Application.py
```
操作流程：

- 系统会展示 10 部经典电影（如《玩具总动员》《勇敢的心》等），用户需为看过的电影评分（1-5 分），未看过的可输入n跳过
- 系统根据用户提供的评分计算用户特征，生成推荐
- 若未提供任何评分，系统将推荐热门高分电影
- 最终展示 5 部推荐电影及预测评分

## 算法说明
- 矩阵分解：将用户 - 电影评分矩阵分解为用户特征矩阵和电影特征矩阵，通过特征向量的点积预测评分
- 评分归一化：使用电影平均评分进行归一化，提升预测准确性
- 正则化：加入 L2 正则化项防止过拟合
- 新用户处理：通过岭回归算法，根据用户提供的少量评分计算其特征向量
- 评分范围控制：严格控制预测评分在 1-5 分范围内，确保结果合理性
## 注意事项
- 首次运行前需确保dataset目录下存在 MovieLens 10% 数据集的ratings.csv和movies.csv
- 模型训练需要一定时间，取决于硬件性能和训练参数设置
- 推荐质量与用户提供的评分数量和质量相关，提供越多合理评分，推荐越精准
- 若models目录不存在或模型文件缺失，需先运行model.py训练模型

## 效果评测
非常差，评分平差1分以上
